## Objetivo

The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it! The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/140/program-redacted.c).

Additional details will be available after launching your challenge instance.


## Solución  

checamos el codigo y vemos que el numero de data que debemos ingresar es 0

```java

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>
#include <stdint.h>
#include <ctype.h>
#include <unistd.h>
#include <sys/time.h>
#include <sys/types.h>


#define WAIT 60


static const char* flag = "[REDACTED]";

static char data[10][100];
static int input_lengths[10];
static int inputs = 0;


 
int tgetinput(char *input, unsigned int l)
{
    fd_set          input_set;
    struct timeval  timeout;
    int             ready_for_reading = 0;
    int             read_bytes = 0;
    
    if( l <= 0 )
    {
      printf("'l' for tgetinput must be greate>
      return -2;
    }
    
    
    /* Empty the FD Set */
    FD_ZERO(&input_set );
    /* Listen to the input descriptor */
    FD_SET(STDIN_FILENO, &input_set);

    /* Waiting for some seconds */
    timeout.tv_sec = WAIT;    // WAIT seconds
    timeout.tv_usec = 0;    // 0 milliseconds

    /* Listening for input stream for any acti>
    ready_for_reading = select(1, &input_set, >
    /* Here, first parameter is number of FDs >
     * second is our FD set for reading,

 GNU nano 8.0   program-redacted.c            
        return -1;
    } 

    if (ready_for_reading) {
        read_bytes = read(0, input, l-1);
        if(input[read_bytes-1]=='\n'){
        --read_bytes;
        input[read_bytes]='\0';
        }
        if(read_bytes==0){
            printf("No data given.\n");
            return -4;
        } else {
            return 0;
        }
    } else {
        printf("Timed out waiting for user inp>
        return -3;
    }

    return 0;
}


static void data_write() {
  char input[100];
  char len[4];
  long length;
  int r;
  
  printf("Please enter your data:\n");
  r = tgetinput(input, 100);

zsh: corrupt history file /home/kali/.zsh_history
┌──(kali㉿kali)-[~/Downloads/basicFIle]
└─$ nc saturn.picoctf.net 51417 
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
1
Please enter your data:
bi 
bi
Please enter the length of your data:
2
2
Your entry number is: 1
Write successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
1
1
bi
Read successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
0
0
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}
                                               
┌──(kali㉿kali)-[~/Downloads/basicFIle]
└─$ 


```


entramos al launcher e ingresamos lo que nos pide, al ingresar la data ingresamos 0
```java
zsh: corrupt history file /home/kali/.zsh_history
┌──(kali㉿kali)-[~/Downloads/basicFIle]
└─$ nc saturn.picoctf.net 51417 
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
1
Please enter your data:
bi 
bi
Please enter the length of your data:
2
2
Your entry number is: 1
Write successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
1
1
bi
Read successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
0
0
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}
                                               
┌──(kali㉿kali)-[~/Downloads/basicFIle]
└─$ 


```

**picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}**
## Notas Adicionales 

### Referencias
